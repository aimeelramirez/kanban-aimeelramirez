"use strict";let dbData=[],data="",queryCheck=!1,itemsList="",parseData="";const token="5b1064585f4ab8706d275f90",endPoint="api/lists?accessToken=",endPointPost="api/items?accessToken=",endPointDel="api/items/";let getBackLogButton=document.getElementById("backlog-button"),getImplementationButton=document.getElementById("implementation-button"),getCompleteButton=document.getElementById("complete-button");const url="https://knowledgeable-inquisitive-tent.glitch.me/"+endPoint+token,postUrl="https://knowledgeable-inquisitive-tent.glitch.me/"+endPointPost+token;let getIcon=document.getElementById("mode");getIcon.className="icon-moon",document.onreadystatechange=(()=>{"complete"!==document.readyState?(document.querySelector("body").style.visibility="hidden",document.querySelector("#spinner").style.visibility="visible"):(document.querySelector("#spinner").style.display="none",document.querySelector("body").style.visibility="visible")});const getDataAPI=async()=>{await fetch(url,{method:"GET"}).then(e=>{parseData=e.json(),console.log(parseData),parseData.then(t=>{console.log(t),onSuccess(t),dbData.push(t),e=dbData[0],dbData=[],console.log(e)}).catch(e=>{console.error(e)})}),await fetch(postUrl,{method:"GET"}).then(e=>{let t="";t=e.json(),getDeleteReadAPI(t)}).catch(e=>{console.log(e)})};getDataAPI();const getDeleteReadAPI=e=>{console.log("parse: "+e),e.then(e=>{console.log(queryCheck),1==queryCheck&&getDeleteTask(e)}).catch(e=>{console.log(e)})},onSuccess=async e=>{if(console.log("Waiting on data to be read, thank you for your patience..."),""!=e){let t=document.querySelectorAll("section");queryCheck=!0;for(let o=0;o<t.length;o++){let n=t[o];"backlog"==n.id?await getBackLog(n,e[0]):"implementation"==n.id?await getImplementation(n,e[1]):"complete"==n.id&&(console.log(n.id),await getComplete(n,e[2]))}}else console.log("Error on data on load.")},postDataAPI=async(e,t)=>{console.log("post"),document.getElementById("modal-dialog").innerHTML='<p id="spinner"><strong>spinner</strong></p>';let o={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)};await fetch(postUrl,o).then(e=>{console.log(e);(e=>{window.setTimeout(()=>{window.location.reload()},2e3)})()}).catch(e=>{throw console.error(e)})},putDataAPI=async(e,t)=>{console.log(e.description);const o="https://knowledgeable-inquisitive-tent.glitch.me/api/items/"+parseInt(t)+"?accessToken="+token;let n={method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({title:e.title,description:e.description,dueDate:e.dueDate,listId:e.listId})};await fetch(o,n).then(e=>{console.log(e);(e=>{window.setTimeout(()=>{window.location.reload()},2e3)})()}).catch(e=>{throw console.error(e)})},deleteDataAPI=async e=>{console.log("delete");const t="https://knowledgeable-inquisitive-tent.glitch.me/api/items/"+e.id+"?accessToken="+token;let o=document.getElementById("modal-dialog");o.style.display="flex";let n=JSON.stringify(e);console.log(n),o.innerHTML='<article id="deletedModal"><h2> Deleted! </h2><br/><p> Title:'+e.title+"</p><p> Description: "+e.description+"</p></article>";await fetch(t,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"}}).then(e=>{console.log(e);(e=>{window.setTimeout(()=>{window.location.reload()},2e3)})()}).catch(e=>{throw console.error(e)})},validateData=(e,t)=>{e.preventDefault();let o="",n=!1,l=document.forms.newerTask,a=document.getElementById("modal-dialog");a.style.display="flex",console.log(a);for(let e in l)if(e<=3)console.log(l[e]),""!=l[1].value&&""!=l[2].value&&""!=l[3].value&&(o={title:l[1].value,description:l[2].value,dueDate:l[3].value,listId:t},n=!0);else if(""==l[1].value&&""==l[2].value&&""==l[3].value)a.innerHTML='<p id="spinner"><strong>spinner</strong></p>',a.innerHTML='<article><p><button id="exit"  type="button"><strong>Exit</strong></button></p>Please fill out all form inputs before submitting</article>',getExitModal();else if(""==l[1].value){a.innerHTML='<p id="spinner"><strong>spinner</strong></p>';let e="error on: task title";a.innerHTML='<article><p><button id="exit"  type="button"><strong>Exit</strong></button></p>'+e+"</article>",getExitModal()}else if(""==l[2].value){a.innerHTML='<p id="spinner"><strong>spinner</strong></p>';let e="error on: task description";a.innerHTML='<article><p><button id="exit" type="button"><strong>Exit</strong></button></p>'+e+"</article>",getExitModal()}else if(""==l[3].value){a.innerHTML='<p id="spinner"><strong>spinner</strong></p>';let e="error on: task date";a.innerHTML='<article> <p><button id="exit"  type="button"><strong>Exit</strong></button></p>'+e+"</article>",getExitModal()}1==n?(a.innerHTML="",postDataAPI(o)):console.log("catch this error.")},getExitModal=()=>{document.getElementById("exit").addEventListener("click",e=>{e.preventDefault();let t=document.getElementById("modal-dialog"),o=document.getElementById("confirmation");null!=o&&(o.innerHTML=""),t.innerHTML=""})},sendData=e=>{if(e.preventDefault(),e.target.id===getBackLogButton.id){console.log("clicked 1: "+e.target.id),createTaskCard("backlog"),document.getElementById("taskSent").addEventListener("click",e=>{validateData(e,1)})}else if(e.target.id===getImplementationButton.id){console.log("clicked 2: "+e.target.id),createTaskCard("implementation"),document.getElementById("taskSent").addEventListener("click",e=>{e.preventDefault(),validateData(e,2)})}else if(e.target.id===getCompleteButton.id){console.log("clicked 3: "+e.target.id),createTaskCard("complete"),document.getElementById("taskSent").addEventListener("click",e=>{e.preventDefault(),validateData(e,3)})}},createTaskCard=e=>{let t=document.getElementById(e).querySelector("article"),o=document.createElement("article");o.id="new",t.insertAdjacentElement("afterend",o),createForms(e)},createForms=()=>{let e=document.getElementById("new"),t=document.createElement("form");t.name="newerTask",e.insertAdjacentElement("beforeend",t);let o=document.createElement("input");o.setAttribute("required",""),o.placeholder="Task title here";let n=document.createElement("textarea");n.setAttribute("required",""),n.placeholder="Task description here";let l=document.createElement("input");l.type="date",l.setAttribute("required","");let a=document.createElement("button");a.id="taskSent",t.insertAdjacentElement("beforeend",a),t.insertAdjacentElement("beforeend",o),t.insertAdjacentElement("beforeend",n),t.insertAdjacentElement("beforeend",l),e.id="",e.className="articleDarkMode"};document.addEventListener("click",function(){document.querySelector("main section#implementation article button").addEventListener("click",sendData),document.querySelector("main section#backlog article button").addEventListener("click",sendData),document.querySelector("main section#complete article button").addEventListener("click",sendData)});let count=0,getIconMode=document.getElementById("mode");getIcon.style.color="white",localStorage.setItem("mode-icon",getIconMode.style.color),getIconMode.addEventListener("click",e=>{e.preventDefault();let t=document.body,o=document.querySelector("header");console.log(t),getIconMode=document.getElementById("mode");let n=document.querySelectorAll("section"),l=document.querySelectorAll("article"),a=document.querySelector("h1");if(a.style.color="black",localStorage.setItem("mode-icon",getIconMode.style.color),count<1){localStorage.removeItem("mode-icon"),o.style.backgroundColor="grey",t.style.backgroundColor="black",o.style.color="black",a.style.color="white";for(let e=1;e<n.length;e++){n[e].style.backgroundColor="#1e2326",n[e].querySelectorAll("h2").forEach(e=>{e.style.color="white"}),localStorage.setItem("mode-section",n[e].style.backgroundColor)}localStorage.setItem("mode-h1",a.style.color),localStorage.setItem("mode",t.style.backgroundColor),localStorage.setItem("mode-header",o.style.cssText),count+=1,console.log("dark mode: "+count),getIconMode.className="icon-sun"}else if(1==count){t.style.cssText="",o.style.cssText="",a.style.cssText="";for(let e=1;e<n.length;e++){n[e].style.cssText="",n[e].querySelectorAll("h2").forEach(e=>{e.style.color=""})}l.forEach((e,t)=>{""!=e.id&&(e.style.backgroundColor="")}),localStorage.clear(),count=0,console.log("light mode: "+count),getIconMode.className="icon-moon"}});