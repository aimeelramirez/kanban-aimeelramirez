"use strict";let dbData=[],data="",parseData="";const token="5b1064585f4ab8706d275f90",endPoint="api/lists?accessToken=",endPointPost="api/items?accessToken=",endPointDel="api/items/";let getBackLogButton=document.getElementById("backlog-button"),getImplementationButton=document.getElementById("implementation-button"),getCompleteButton=document.getElementById("complete-button");const url="https://knowledgeable-inquisitive-tent.glitch.me/"+endPoint+token,postUrl="https://knowledgeable-inquisitive-tent.glitch.me/"+endPointPost+token,getDataAPI=async()=>{await fetch(postUrl,{method:"GET"}).then(e=>{parseData=e.json(),console.log(parseData)}),await fetch(url,{method:"GET"}).then(e=>{let t=e.json();console.log(t),t.then(t=>{console.log(t),onSuccess(t),dbData.push(t),e=dbData[0],dbData=[],console.log(e)}).catch(e=>console.error(e))}).catch(e=>{console.log(e)})},getDeleteReadAPI=async()=>{await fetch(postUrl,{method:"GET"}).then(e=>{parseData=e.json(),console.log(parseData),getDeleteTask(parseData)}).catch(e=>{console.log(e)})},onSuccess=async e=>{if(console.log("Waiting on data to be read, thank you for your patience..."),""!=e){let t=document.querySelectorAll("section");for(let n=0;n<t.length;n++){let o=t[n];"backlog"==o.id?await getBackLog(o,e[0]):"implementation"==o.id?await getImplementation(o,e[1]):"complete"==o.id&&(console.log(o.id),await getComplete(o,e[2]))}}else console.log("Error on data on load.")},postDataAPI=async(e,t)=>{console.log("post");let n=document.querySelector("nav"),o=document.createElement("article");o.id="message",n.insertAdjacentElement("beforebegin",o),document.getElementById("message").innerHTML='<p> "Sent, please wait until being added! "</p></p>'+JSON.stringify(e)+"</p>";let a={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)};await fetch(postUrl,a).then(e=>{console.log(e);(e=>{window.setTimeout(()=>{window.location.reload()},2e3)})()}).catch(e=>{throw console.error(e)})},deleteDataAPI=async e=>{console.log("delete");const t="https://knowledgeable-inquisitive-tent.glitch.me/api/items/"+e+"?accessToken="+token;let n=document.querySelector("nav"),o=document.createElement("article");o.id="message",n.insertAdjacentElement("beforebegin",o),document.getElementById("message").innerHTML='<p> "Deleted! "</p></p>'+JSON.stringify(e)+"</p>";await fetch(t,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"}}).then(e=>{console.log(e);(e=>{window.setTimeout(()=>{window.location.reload()},2e3)})()}).catch(e=>{throw console.error(e)})},validateData=(e,t)=>{e.preventDefault();let n="",o=!1,a=document.forms.newerTask,l=document.querySelector("nav"),c=document.createElement("article");c.id="message",l.insertAdjacentElement("beforebegin",c);let i=document.getElementById("message");for(let e in a)if(e<=3)console.log(a[e]),""!=a[1].value&&""!=a[2].value&&""!=a[3].value&&(n={title:a[1].value,description:a[2].value,dueDate:a[3].value,listId:t},o=!0);else{if(""==a[1].value&&""==a[2].value&&""==a[3].value)return i.innerHTML="<p> Please fill out all form inputs before submitting</p>",null;if(""==a[1].value){let e="error on: task title";i.innerHTML="<p>"+e+"</p>",console.log(e);break}if(""==a[2].value){let e="error on: task description";i.innerHTML="<p>"+e+"</p>",console.log(e);break}if(""==a[3].value){let e="error on: task date";i.innerHTML="<p>"+e+"</p>",console.log(e);break}}1==o?(i.remove(),postDataAPI(n)):console.log("catch this error.")},sendData=e=>{if(e.preventDefault(),e.target.id===getBackLogButton.id){console.log("clicked 1: "+e.target.id),createTaskCard("backlog"),document.getElementById("taskSent").addEventListener("click",e=>{validateData(e,1)})}else if(e.target.id===getImplementationButton.id){console.log("clicked 2: "+e.target.id),createTaskCard("implementation"),document.getElementById("taskSent").addEventListener("click",e=>{e.preventDefault(),validateData(e,2)})}else if(e.target.id===getCompleteButton.id){console.log("clicked 3: "+e.target.id),createTaskCard("complete"),document.getElementById("taskSent").addEventListener("click",e=>{e.preventDefault(),validateData(e,3)})}},createTaskCard=e=>{console.log(e);let t=document.getElementById(e).querySelector("article"),n=document.createElement("article");n.id="new",t.insertAdjacentElement("afterend",n),createForms(e)},createForms=()=>{let e=document.getElementById("new"),t=document.createElement("form");t.name="newerTask",e.insertAdjacentElement("beforeend",t);let n=document.createElement("input");n.setAttribute("required",""),n.placeholder="Task title here";let o=document.createElement("textarea");o.setAttribute("required",""),o.placeholder="Task description here";let a=document.createElement("input");a.type="date",a.setAttribute("required","");let l=document.createElement("button");l.id="taskSent",t.insertAdjacentElement("beforeend",l),t.insertAdjacentElement("beforeend",n),t.insertAdjacentElement("beforeend",o),t.insertAdjacentElement("beforeend",a),e.id=""};getDataAPI(),document.addEventListener("click",function(){document.querySelector("main section#implementation article button").addEventListener("click",sendData),document.querySelector("main section#backlog article button").addEventListener("click",sendData),document.querySelector("main section#complete article button").addEventListener("click",sendData)}),getDeleteReadAPI();