"use strict";let dbData=[],data="",queryCheck=!1,itemsList="",parseData="";const token="5b1064585f4ab8706d275f90",endPoint="api/lists?accessToken=",endPointPost="api/items?accessToken=",endPointDel="api/items/";let getBackLogButton=document.getElementById("backlog-button"),getImplementationButton=document.getElementById("implementation-button"),getCompleteButton=document.getElementById("complete-button");const url="https://knowledgeable-inquisitive-tent.glitch.me/"+endPoint+token,postUrl="https://knowledgeable-inquisitive-tent.glitch.me/"+endPointPost+token;let getIcon=document.getElementById("mode");getIcon.className="icon-moon",document.onreadystatechange=(()=>{"complete"!==document.readyState?(document.querySelector("body").style.visibility="hidden",document.querySelector("#spinner").style.visibility="visible"):(document.querySelector("#spinner").style.display="none",document.querySelector("body").style.visibility="visible")});const getDataAPI=async()=>{await fetch(url,{method:"GET"}).then(e=>{(parseData=e.json()).then(t=>{onSuccess(t),dbData.push(t),e=dbData[0],dbData=[]}).catch(e=>{console.error(e)})}),await fetch(postUrl,{method:"GET"}).then(e=>{let t="";t=e.json(),getDeleteReadAPI(t)}).catch(e=>{console.log(e)})};getDataAPI();const getDeleteReadAPI=e=>{e.then(e=>{1==queryCheck&&getDeleteTask(e)}).catch(e=>{console.log(e)})},onSuccess=async e=>{if(console.log("Waiting on data to be read, thank you for your patience..."),""!=e){let t=document.querySelectorAll("section");queryCheck=!0;for(let n=0;n<t.length;n++){let o=t[n];"backlog"==o.id?await getBackLog(o,e[0]):"implementation"==o.id?await getImplementation(o,e[1]):"complete"==o.id&&await getComplete(o,e[2])}}else console.log("Error on data on load.")},postDataAPI=async(e,t)=>{console.log("posting"),document.getElementById("modal-dialog").innerHTML='<p id="spinner"><strong>spinner</strong></p>';let n={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)};await fetch(postUrl,n).then(e=>{(e=>{window.setTimeout(()=>{window.location.reload()},2e3)})()}).catch(e=>{throw console.error(e)})},putDataAPI=async(e,t)=>{const n="https://knowledgeable-inquisitive-tent.glitch.me/api/items/"+parseInt(t)+"?accessToken="+token;let o={method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({title:e.title,description:e.description,dueDate:e.dueDate,listId:e.listId})};await fetch(n,o).then(e=>{(e=>{window.setTimeout(()=>{window.location.reload()},2e3)})()}).catch(e=>{throw console.error(e)})},deleteDataAPI=async e=>{console.log("deleting");const t="https://knowledgeable-inquisitive-tent.glitch.me/api/items/"+e.id+"?accessToken="+token;let n=document.getElementById("modal-dialog");n.style.display="flex",n.innerHTML='<p id="spinner"><strong>spinner</strong></p>',n.innerHTML='<article id="deletedModal"><h2> success on deleted! </h2><br/><h3> Title:</h3><p>'+e.title+"<h3> Description:</h3>"+e.description+"</p></article>";await fetch(t,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"}}).then(e=>{(e=>{window.setTimeout(()=>{window.location.reload()},2e3)})()}).catch(e=>{throw console.error(e)})},validateData=(e,t)=>{e.preventDefault();let n="",o=!1,l=document.getElementsByClassName("articleDarkMode")[0].childNodes[0].elements,a=document.getElementById("modal-dialog");a.style.display="flex";let i=l[2].value.match(/^\d{4}([./-])\d{2}\1\d{2}$/);for(let e in l)if(e<=3){if(""!=l[2].value&&!i){a.innerHTML='<p id="spinner"><strong>spinner</strong></p>';let e="error on: task date";a.innerHTML='<article> <p><button id="exit"  type="button"><strong>Exit</strong></button></p>'+e+"</article>",getExitModal()}}else if(""!=l[0].value&&""!=l[1].value&&""!=l[2].value&&i)n={title:l[0].value,description:l[1].value,dueDate:l[2].value,listId:t},o=!0;else if(""==l[0].value&&""==l[1].value&&""==l[2].value)a.innerHTML='<p id="spinner"><strong>spinner</strong></p>',a.innerHTML='<article><p><button id="exit"  type="button"><strong>Exit</strong></button></p>Please fill out all form inputs before submitting</article>',getExitModal();else if(""==l[0].value){a.innerHTML='<p id="spinner"><strong>spinner</strong></p>';let e="error on: task title";a.innerHTML='<article><p><button id="exit"  type="button"><strong>Exit</strong></button></p>'+e+"</article>",getExitModal()}else if(""==l[1].value){a.innerHTML='<p id="spinner"><strong>spinner</strong></p>';let e="error on: task description";a.innerHTML='<article><p><button id="exit" type="button"><strong>Exit</strong></button></p>'+e+"</article>",getExitModal()}else if(""==l[2].value){a.innerHTML='<p id="spinner"><strong>spinner</strong></p>';let e="error on: task date";a.innerHTML='<article> <p><button id="exit"  type="button"><strong>Exit</strong></button></p>'+e+"</article>",getExitModal()}1==o?(a.innerHTML="",postDataAPI(n)):console.log("catch this error.")},getExitModal=()=>{document.getElementById("exit").addEventListener("click",e=>{e.preventDefault();let t=document.getElementById("modal-dialog"),n=document.getElementById("confirmation");null!=n&&(n.innerHTML=""),t.innerHTML=""})},sendData=e=>{if(e.preventDefault(),e.target.id===getBackLogButton.id){createTaskCard("backlog"),document.getElementById("taskSent").addEventListener("click",e=>{validateData(e,1)})}else if(e.target.id===getImplementationButton.id){createTaskCard("implementation"),document.getElementById("taskSent").addEventListener("click",e=>{e.preventDefault(),validateData(e,2)})}else if(e.target.id===getCompleteButton.id){createTaskCard("complete"),document.getElementById("taskSent").addEventListener("click",e=>{e.preventDefault(),validateData(e,3)})}},createTaskCard=e=>{let t=document.getElementById(e).querySelector("article"),n=document.createElement("article");n.id="new",t.insertAdjacentElement("afterend",n),createForms(e)},createForms=()=>{let e=document.getElementById("new"),t=document.createElement("form");t.name="newerTask",e.insertAdjacentElement("beforeend",t);let n=document.createElement("input");n.setAttribute("required",""),n.placeholder="Task title here";let o=document.createElement("textarea");o.setAttribute("required",""),o.placeholder="Task description here";let l=document.createElement("input");l.type="date",l.placeholder="2021-01-31",l.setAttribute("required","");let a=document.createElement("button");a.id="taskSent",t.insertAdjacentElement("afterend",a),t.insertAdjacentElement("beforeend",n),t.insertAdjacentElement("beforeend",o),t.insertAdjacentElement("beforeend",l),e.id="",e.className="articleDarkMode"};document.addEventListener("click",function(){document.querySelector("main section#implementation article button").addEventListener("click",sendData),document.querySelector("main section#backlog article button").addEventListener("click",sendData),document.querySelector("main section#complete article button").addEventListener("click",sendData)});let count=0,getIconMode=document.getElementById("mode");getIcon.style.color="white",localStorage.setItem("mode-icon",getIconMode.style.color),getIconMode.addEventListener("click",e=>{e.preventDefault();let t=document.body,n=document.querySelector("header");getIconMode=document.getElementById("mode");let o=document.querySelectorAll("section"),l=document.querySelectorAll("article"),a=document.querySelector("h1");if(a.style.color="black",count<1){localStorage.removeItem("mode-icon"),n.style.backgroundColor="grey",t.style.backgroundColor="black",n.style.color="black",a.style.color="white";for(let e=1;e<o.length;e++){o[e].style.backgroundColor="#1e2326",o[e].querySelectorAll("h2").forEach(e=>{e.style.color="white"}),localStorage.setItem("mode-section",o[e].style.backgroundColor)}localStorage.setItem("mode-icon",getIconMode.style.color),localStorage.setItem("mode-h1",a.style.color),localStorage.setItem("mode",t.style.backgroundColor),localStorage.setItem("mode-header",n.style.cssText),count+=1,getIconMode.className="icon-sun"}else if(1==count){t.style.cssText="",n.style.cssText="",a.style.cssText="";for(let e=1;e<o.length;e++){o[e].style.cssText="",o[e].querySelectorAll("h2").forEach(e=>{e.style.color=""})}l.forEach((e,t)=>{""!=e.id&&(e.style.backgroundColor="")}),localStorage.clear(),count=0,getIconMode.className="icon-moon"}});