"use strict";let dbData=[],data="",queryCheck=!1,itemsList="";const token="5b1064585f4ab8706d275f90",endPoint="api/lists?accessToken=",endPointPost="api/items?accessToken=",endPointDel="api/items/";let getBackLogButton=document.getElementById("backlog-button"),getImplementationButton=document.getElementById("implementation-button"),getCompleteButton=document.getElementById("complete-button");const url="https://knowledgeable-inquisitive-tent.glitch.me/"+endPoint+token,postUrl="https://knowledgeable-inquisitive-tent.glitch.me/"+endPointPost+token,getDataAPI=async()=>{await fetch(url,{method:"GET"}).then(e=>{let t=e.json();console.log(t),t.then(t=>{console.log(t),onSuccess(t),dbData.push(t),e=dbData[0],dbData=[],console.log(e)}).catch(e=>console.error(e))}),await fetch(postUrl,{method:"GET"}).then(e=>{let t="";t=e.json(),getDeleteReadAPI(t)}).catch(e=>{console.log(e)})};getDataAPI();let getIcon=document.getElementById("mode");getIcon.className="icon-sun";const getDeleteReadAPI=e=>{console.log("parse: "+e),e.then(e=>{console.log(queryCheck),1==queryCheck&&getDeleteTask(e)}).catch(e=>{console.log(e)})},onSuccess=async e=>{if(console.log("Waiting on data to be read, thank you for your patience..."),""!=e){let t=document.querySelectorAll("section");queryCheck=!0;for(let n=0;n<t.length;n++){let o=t[n];"backlog"==o.id?await getBackLog(o,e[0]):"implementation"==o.id?await getImplementation(o,e[1]):"complete"==o.id&&(console.log(o.id),await getComplete(o,e[2]))}}else console.log("Error on data on load.")},postDataAPI=async(e,t)=>{console.log("post"),document.getElementById("modal-dialog").innerHTML='<p class="spinner"><strong>spinner</strong></p>';let n={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)};await fetch(postUrl,n).then(e=>{console.log(e);(e=>{window.setTimeout(()=>{window.location.reload()},2e3)})()}).catch(e=>{throw console.error(e)})},putDataAPI=async(e,t)=>{console.log(e.description);const n="https://knowledgeable-inquisitive-tent.glitch.me/api/items/"+parseInt(t)+"?accessToken="+token;let o={method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({title:e.title,description:e.description,dueDate:e.dueDate,listId:e.listId})};await fetch(n,o).then(e=>{console.log(e);(e=>{window.setTimeout(()=>{window.location.reload()},2e3)})()}).catch(e=>{throw console.error(e)})},deleteDataAPI=async e=>{console.log("delete");const t="https://knowledgeable-inquisitive-tent.glitch.me/api/items/"+e.id+"?accessToken="+token;let n=document.getElementById("modal-dialog");n.style.display="flex",n.innerHTML='<article><p> "Deleted! "</p></p>'+JSON.stringify(e)+"</p></article>";await fetch(t,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"}}).then(e=>{console.log(e);(e=>{window.setTimeout(()=>{window.location.reload()},2e3)})()}).catch(e=>{throw console.error(e)})},validateData=(e,t)=>{e.preventDefault();let n="",o=!1,l=document.forms.newerTask,a=document.getElementById("modal-dialog");a.style.display="flex",console.log(a);for(let e in l)if(e<=3)console.log(l[e]),""!=l[1].value&&""!=l[2].value&&""!=l[3].value&&(n={title:l[1].value,description:l[2].value,dueDate:l[3].value,listId:t},o=!0);else if(""==l[1].value&&""==l[2].value&&""==l[3].value)a.innerHTML='<p class="spinner"><strong>spinner</strong></p>',a.innerHTML='<article><button id="exit"  type="button"><strong>Exit</strong></button>Please fill out all form inputs before submitting</article>',getExitModal();else if(""==l[1].value){a.innerHTML='<p class="spinner"><strong>spinner</strong></p>';let e="error on: task title";a.innerHTML='<article><button id="exit"  type="button"><strong>Exit</strong></button>'+e+"</article>",getExitModal()}else if(""==l[2].value){a.innerHTML='<p class="spinner"><strong>spinner</strong></p>';let e="error on: task description";a.innerHTML='<article><button id="exit" type="button"><strong>Exit</strong></button>'+e+"</article>",getExitModal()}else if(""==l[3].value){a.innerHTML='<p class="spinner"><strong>spinner</strong></p>';let e="error on: task date";a.innerHTML='<article> <button id="exit" type="button"><strong>Exit</strong></button>'+e+"</article>",getExitModal()}1==o?(a.innerHTML="",postDataAPI(n)):console.log("catch this error.")},getExitModal=()=>{document.getElementById("exit").addEventListener("click",e=>{e.preventDefault();let t=document.getElementById("modal-dialog"),n=document.getElementById("confirmation");null!=n&&(n.innerHTML=""),t.innerHTML=""})},sendData=e=>{if(e.preventDefault(),e.target.id===getBackLogButton.id){console.log("clicked 1: "+e.target.id),createTaskCard("backlog"),document.getElementById("taskSent").addEventListener("click",e=>{validateData(e,1)})}else if(e.target.id===getImplementationButton.id){console.log("clicked 2: "+e.target.id),createTaskCard("implementation"),document.getElementById("taskSent").addEventListener("click",e=>{e.preventDefault(),validateData(e,2)})}else if(e.target.id===getCompleteButton.id){console.log("clicked 3: "+e.target.id),createTaskCard("complete"),document.getElementById("taskSent").addEventListener("click",e=>{e.preventDefault(),validateData(e,3)})}},createTaskCard=e=>{console.log(e);let t=document.getElementById(e).querySelector("article"),n=document.createElement("article");n.id="new",t.insertAdjacentElement("afterend",n),createForms(e)},createForms=()=>{let e=document.getElementById("new"),t=document.createElement("form");t.name="newerTask",e.insertAdjacentElement("beforeend",t);let n=document.createElement("input");n.setAttribute("required",""),n.placeholder="Task title here";let o=document.createElement("textarea");o.setAttribute("required",""),o.placeholder="Task description here";let l=document.createElement("input");l.type="date",l.setAttribute("required","");let a=document.createElement("button");a.id="taskSent",t.insertAdjacentElement("beforeend",a),t.insertAdjacentElement("beforeend",n),t.insertAdjacentElement("beforeend",o),t.insertAdjacentElement("beforeend",l),e.id=""};document.addEventListener("click",function(){document.querySelector("main section#implementation article button").addEventListener("click",sendData),document.querySelector("main section#backlog article button").addEventListener("click",sendData),document.querySelector("main section#complete article button").addEventListener("click",sendData)});let count=0;document.getElementById("mode").addEventListener("click",e=>{e.preventDefault();let t=document.body,n=document.getElementById("mode");count<1?(localStorage.removeItem("mode"),t.style.backgroundColor="white",localStorage.setItem("mode",t.style.backgroundColor),localStorage.getItem("mode"),count+=1,console.log("light mode: "+count),n.className="icon-sun"):1==count&&(localStorage.removeItem("mode"),t.style.backgroundColor="black",localStorage.setItem("mode",t.style.backgroundColor),localStorage.getItem("mode"),count=0,console.log("dark mode: "+count),n.className="icon-moon")});